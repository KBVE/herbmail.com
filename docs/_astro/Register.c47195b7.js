import{S as Te,i as ze,s as Ue,e as _e,a as U,b as m,t as Ne,h as Pe,d as k,c as N,f as p,g as A,j as X,k as Oe,l,m as c,n as me,o as Y,p as te,q as Re,r as pe,u as Ie,v as Ae,w as De,x as Me,y as qe,z as Fe}from"./index.3130c7e9.js";const Be="/api/v1/",Je="5ba581fa-b6fc-4bb0-8222-02fcd6a59e35",He="https://js.hcaptcha.com/1/api.js",We="auth/register";class L{status;error;message;data;constructor(t,r,a){this.status=t,this.error=t<200||t>=300,this.message=r,this.data=a}display(){console.log(`Status: ${this.status}, Message: ${this.message}, Error: ${this.error}, Data: ${JSON.stringify(this.data)}`)}scope(){try{return JSON.stringify(this.data)}catch(t){return console.error("Parsing error:",t),"Error: Unable to parse data"}}async serialize(){try{return JSON.stringify({status:this.status,error:this.error,message:this.message,data:this.data})}catch(t){return console.error("Serialization error:",t),JSON.stringify({status:500,error:!0,message:"Internal Server Error: Unable to serialize response",data:{}})}}static async deserialize(t){try{const r=JSON.parse(t);return new L(r.status,r.message,r.data)}catch(r){return console.error("Deserialization error:",r),new L(500,"Internal Server Error: Unable to deserialize response",{})}}}const Ye=new RegExp(/^[a-z0-9]+$/i),ke=8,Qe=async e=>e.length<ke?new L(400,"Validation Error",{error:"Username is too short. Minimum length is "+ke}):Ye.test(e)?new L(200,"Validation Successful",{message:"Username is valid."}):new L(400,"Validation Error",{error:"Username contains invalid characters."});async function Ze(e){try{const t=await Qe(e);return t.status===200?{isValid:!0,error:null}:{isValid:!1,error:t.data.error}}catch{return{isValid:!1,error:"An unexpected error occurred"}}}const Ge=new RegExp(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/),Ke=async e=>Ge.test(e)?new L(200,"Validation Successful",{message:"Email is valid."}):new L(400,"Validation Error",{error:"Email is invalid."});async function Xe(e){try{const t=await Ke(e);return t.status===200?{isValid:!0,error:null}:{isValid:!1,error:t.data.error}}catch{return{isValid:!1,error:"An unexpected error occurred"}}}const je=async e=>{if(e.length<8)return new L(400,"Validation Error",{error:"Password is too short"});if(e.length>255)return new L(400,"Validation Error",{error:"Password is too long"});const t=/[A-Z]/.test(e),r=/[a-z]/.test(e),a=/\d/.test(e),s=/[^A-Za-z0-9]/.test(e);return!t||!r||!a||!s?new L(400,"Validation Error",{error:"Password must include uppercase, lowercase, digits, and special characters"}):new L(200,"Validation Successful",{message:"Password is valid"})};async function $e(e){try{const t=await je(e);return t.status===200?{isValid:!0,error:null}:{isValid:!1,error:t.data.error}}catch{return{isValid:!1,error:"An unexpected error occurred"}}}async function et(e,t,r){try{const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...r},body:JSON.stringify(t)}),s=await a.json(),i=s.message||(a.ok?"Success":"Error"),S=!a.ok&&s.error?{error:s.error}:s;return new L(a.status,i,S)}catch(a){return console.error("Request failed:",a),new L(500,"Internal Server Error: Request failed",{})}}async function tt(e,t,r,a,s){const i=`${e}${Be}${We}`;return et(i,{username:t,email:r,password:a,token:s},{"x-kbve-shieldwall":"auth-register"})}let he=0,Le=[];function rt(){return he+=1,()=>{if(he-=1,he===0){let e=Le;Le=[];for(let t of e)t()}}}function st(e){let t=rt();return e().finally(t)}let _=[],ge=(e,t)=>{let r=[],a={get(){return a.lc||a.listen(()=>{})(),a.value},l:t||0,lc:0,listen(s,i){return a.lc=r.push(s,i||a.l)/2,()=>{let n=r.indexOf(s);~n&&(r.splice(n,2),a.lc--,a.lc||a.off())}},notify(s){let i=!_.length;for(let n=0;n<r.length;n+=2)_.push(r[n],a.value,s,r[n+1]);if(i){for(let n=0;n<_.length;n+=4){let S=!1;for(let g=n+7;g<_.length;g+=4)if(_[g]<_[n+3]){S=!0;break}S?_.push(_[n],_[n+1],_[n+2],_[n+3]):_[n](_[n+1],_[n+2])}_.length=0}},off(){},set(s){a.value!==s&&(a.value=s,a.notify())},subscribe(s,i){let n=a.listen(s,i);return s(a.value),n},value:e};return a};const at=5,ce=6,ue=10;let nt=(e,t,r,a)=>(e.events=e.events||{},e.events[r+ue]||(e.events[r+ue]=a(s=>{e.events[r].reduceRight((i,n)=>(n(i),i),{shared:{},...s})})),e.events[r]=e.events[r]||[],e.events[r].push(t),()=>{let s=e.events[r],i=s.indexOf(t);s.splice(i,1),s.length||(delete e.events[r],e.events[r+ue](),delete e.events[r+ue])}),it=1e3,lt=(e,t)=>nt(e,a=>{let s=t(a);s&&e.events[ce].push(s)},at,a=>{let s=e.listen;e.listen=(...n)=>(!e.lc&&!e.active&&(e.active=!0,a()),s(...n));let i=e.off;return e.events[ce]=[],e.off=()=>{i(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let n of e.events[ce])n();e.events[ce]=[]}},it)},()=>{e.listen=s,e.off=i}}),ot=(e={})=>{let t=ge(e);return t.setKey=function(r,a){typeof a>"u"?r in t.value&&(t.value={...t.value},delete t.value[r],t.notify(r)):t.value[r]!==a&&(t.value={...t.value,[r]:a},t.notify(r))},t},Se=e=>e,re={},Q={addEventListener(){},removeEventListener(){}};function ct(){try{return typeof localStorage<"u"}catch{return!1}}ct()&&(re=localStorage);let ut={addEventListener(e,t,r){window.addEventListener("storage",t),window.addEventListener("pageshow",r)},removeEventListener(e,t,r){window.removeEventListener("storage",t),window.removeEventListener("pageshow",r)}};typeof window<"u"&&(Q=ut);function dt(e,t={},r={}){let a=r.encode||Se,s=r.decode||Se,i=ot(),n=i.setKey;i.setKey=(u,d)=>{typeof d>"u"?(r.listen!==!1&&Q.perKey&&Q.removeEventListener(e+u,g,f),delete re[e+u]):(r.listen!==!1&&Q.perKey&&!(u in i.value)&&Q.addEventListener(e+u,g,f),re[e+u]=a(d)),n(u,d)};let S=i.set;i.set=function(u){for(let d in u)i.setKey(d,u[d]);for(let d in i.value)d in u||i.setKey(d)};function g(u){u.key?u.key.startsWith(e)&&(u.newValue===null?n(u.key.slice(e.length),void 0):n(u.key.slice(e.length),s(u.newValue))):S({})}function f(){let u={...t};for(let d in re)d.startsWith(e)&&(u[d.slice(e.length)]=s(re[d]));i.set(u)}return lt(i,()=>{if(f(),r.listen!==!1)return Q.addEventListener(e,g,f),()=>{Q.removeEventListener(e,g,f);for(let u in i.value)Q.removeEventListener(e+u,g,f)}}),i}const ft=ge(""),ve=ge("");dt("kbve:");ve.subscribe(e=>{console.log(`[TOAST] -> ${e}`)});const de=async e=>{st(async()=>{ft.set(e),ve.set(e)})};function Ve(e){let t,r;return{c(){t=m("script"),this.h()},l(a){t=p(a,"SCRIPT",{src:!0});var s=A(t);s.forEach(k),this.h()},h(){Fe(t.src,r=e[7])||l(t,"src",r),t.async=!0,t.defer=!0},m(a,s){me(a,t,s)},p:pe,d(a){a&&k(t)}}}function ht(e){let t,r,a,s,i,n,S="Your email",g,f,u,d,C,G="Your Username",P,x,D,O,E,R="Password",M,y,j,q,T,se="Confirm Password",F,v,H,V,K,B,ae='<div class="flex items-start"></div> <a href="/account/recovery" class="text-sm font-medium text-kbve-primary-light hover:underline">Forgot password?</a>',$,I,o,ee="Register",W,J,Z,ye='Have an account yet? <a href="/account/login" class="font-medium hover:underline">Login!</a>',fe,we,w=e[1]&&!window?.hcaptcha&&Ve(e);return{c(){w&&w.c(),t=_e(),r=U(),a=m("section"),s=m("form"),i=m("div"),n=m("label"),n.textContent=S,g=U(),f=m("input"),u=U(),d=m("div"),C=m("label"),C.textContent=G,P=U(),x=m("input"),D=U(),O=m("div"),E=m("label"),E.textContent=R,M=U(),y=m("input"),j=U(),q=m("div"),T=m("label"),T.textContent=se,F=U(),v=m("input"),H=U(),V=m("div"),K=U(),B=m("div"),B.innerHTML=ae,$=U(),I=m("button"),o=m("span"),W=Ne(ee),J=U(),Z=m("p"),Z.innerHTML=ye,this.h()},l(h){const z=Pe("svelte-xzymey",document.head);w&&w.l(z),t=_e(),z.forEach(k),r=N(h),a=p(h,"SECTION",{class:!0});var be=A(a);s=p(be,"FORM",{class:!0,action:!0});var b=A(s);i=p(b,"DIV",{});var ne=A(i);n=p(ne,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),X(n)!=="svelte-1bx9lff"&&(n.textContent=S),g=N(ne),f=p(ne,"INPUT",{type:!0,name:!0,id:!0,class:!0,placeholder:!0}),ne.forEach(k),u=N(b),d=p(b,"DIV",{});var ie=A(d);C=p(ie,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),X(C)!=="svelte-mwdljj"&&(C.textContent=G),P=N(ie),x=p(ie,"INPUT",{type:!0,name:!0,id:!0,class:!0,placeholder:!0}),ie.forEach(k),D=N(b),O=p(b,"DIV",{});var le=A(O);E=p(le,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),X(E)!=="svelte-48z9qy"&&(E.textContent=R),M=N(le),y=p(le,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,class:!0}),le.forEach(k),j=N(b),q=p(b,"DIV",{});var oe=A(q);T=p(oe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),X(T)!=="svelte-oro9gy"&&(T.textContent=se),F=N(oe),v=p(oe,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,class:!0}),oe.forEach(k),H=N(b),V=p(b,"DIV",{id:!0,class:!0}),A(V).forEach(k),K=N(b),B=p(b,"DIV",{class:!0,"data-svelte-h":!0}),X(B)!=="svelte-irgx61"&&(B.innerHTML=ae),$=N(b),I=p(b,"BUTTON",{type:!0,class:!0});var xe=A(I);o=p(xe,"SPAN",{});var Ee=A(o);W=Oe(Ee,ee),Ee.forEach(k),xe.forEach(k),J=N(b),Z=p(b,"P",{class:!0,"data-svelte-h":!0}),X(Z)!=="svelte-1h8r17p"&&(Z.innerHTML=ye),b.forEach(k),be.forEach(k),this.h()},h(){l(n,"for","email"),l(n,"class","block mb-2 text-sm font-medium"),l(f,"type","email"),l(f,"name","email"),l(f,"id","email"),l(f,"class","bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"),l(f,"placeholder","name@company.com"),f.required=!0,l(C,"for","username"),l(C,"class","block mb-2 text-sm font-medium"),l(x,"type","text"),l(x,"name","username"),l(x,"id","username"),l(x,"class","bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"),l(x,"placeholder","Username-chan"),x.required=!0,l(E,"for","password"),l(E,"class","block mb-2 text-sm font-medium"),l(y,"type","password"),l(y,"name","password"),l(y,"id","password"),l(y,"placeholder","••••••••"),l(y,"class","bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"),y.required=!0,l(T,"for","password"),l(T,"class","block mb-2 text-sm font-medium"),l(v,"type","password"),l(v,"name","confirm"),l(v,"id","confirm"),l(v,"placeholder","••••••••"),l(v,"class","bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"),v.required=!0,l(V,"id","h-captcha-"+e[6]),l(V,"class","flex justify-center"),l(B,"class","flex items-center justify-between"),l(I,"type","submit"),l(I,"class","w-full bg-offset/[.75] hover:bg-offset focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"),I.disabled=mt,l(Z,"class","text-sm font-light"),l(s,"class","space-y-4 md:space-y-6"),l(s,"action","#"),l(a,"class",e[0])},m(h,z){w&&w.m(document.head,null),c(document.head,t),me(h,r,z),me(h,a,z),c(a,s),c(s,i),c(i,n),c(i,g),c(i,f),Y(f,e[3]),c(s,u),c(s,d),c(d,C),c(d,P),c(d,x),Y(x,e[2]),c(s,D),c(s,O),c(O,E),c(O,M),c(O,y),Y(y,e[5]),c(s,j),c(s,q),c(q,T),c(q,F),c(q,v),Y(v,e[4]),c(s,H),c(s,V),c(s,K),c(s,B),c(s,$),c(s,I),c(I,o),c(o,W),c(s,J),c(s,Z),fe||(we=[te(f,"input",e[22]),te(x,"input",e[23]),te(y,"input",e[24]),te(v,"input",e[25]),te(s,"submit",Re(e[8]))],fe=!0)},p(h,z){h[1]&&!window?.hcaptcha?w?w.p(h,z):(w=Ve(h),w.c(),w.m(t.parentNode,t)):w&&(w.d(1),w=null),z[0]&8&&f.value!==h[3]&&Y(f,h[3]),z[0]&4&&x.value!==h[2]&&Y(x,h[2]),z[0]&32&&y.value!==h[5]&&Y(y,h[5]),z[0]&16&&v.value!==h[4]&&Y(v,h[4]),z[0]&1&&l(a,"class",h[0])},i:pe,o:pe,d(h){h&&(k(r),k(a)),w&&w.d(h),k(t),fe=!1,Ie(we)}}}var Ce=(e=>(e.DARK="dark",e.LIGHT="light",e))(Ce||{});let mt=!1;function pt(e,t,r){let a;Ae(e,ve,o=>r(28,a=o));const s=De();let{domain:i=""}=t,{className:n=""}=t,{redirect:S=!1}=t,{sitekey:g=Je}=t,{apihost:f=He}=t,{hl:u=""}=t,{reCaptchaCompat:d=!1}=t,{theme:C=Ce.DARK}=t,{size:G="compact"}=t;const P=()=>{E&&R&&M&&hcaptcha.reset(M)},x=o=>{if(E&&R&&M)return hcaptcha.execute(M,o)},D=()=>{E&&R&&new Toastify({text:a,duration:3e3,destination:"#",newWindow:!1,close:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"linear-gradient(to right, #FF8A4C, #8DA2FB)"}}).showToast()},O=Math.floor(Math.random()*100);let E=!1,R=!1,M,y;const j=new URLSearchParams({recaptchacompat:d?"on":"off",onload:"hcaptchaOnLoad",render:"explicit"}),q=`${f}?${j.toString()}`;Me(()=>{g||r(9,g=window.sitekey),window.hcaptchaOnLoad=()=>{s("load"),r(20,R=!0)},window.onSuccess=o=>{s("success",{token:o}),K=o},window.onError=()=>{s("error")},window.onClose=()=>{s("close")},window.onExpired=()=>{s("expired"),P()},s("mount"),r(1,E=!0)}),qe(()=>{window.hcaptchaOnLoad=null,window.onSuccess=null,R&&(hcaptcha=null)});async function T(o,ee){try{const{isValid:W,error:J}=await o(ee);return W?!0:(P(),J&&(de(J),D()),!1)}catch(W){return P(),console.error(W),!1}}const se=async()=>{if(!await T(Ze,F)||!await T(Xe,v)||!await T($e,V))return;if(V!==H){P(),de("Passwords do not match!"),D();return}const J=await tt("https://rust.kbve.com",F,v,V,K);if(J.error){P(),de(J.scope()),D();return}else de("Registeration was successful!"),D();console.log("Register task EoL")};let F="",v="",H="",V="",K="";function B(){v=this.value,r(3,v)}function ae(){F=this.value,r(2,F)}function $(){V=this.value,r(5,V)}function I(){H=this.value,r(4,H)}return e.$$set=o=>{"domain"in o&&r(10,i=o.domain),"className"in o&&r(0,n=o.className),"redirect"in o&&r(11,S=o.redirect),"sitekey"in o&&r(9,g=o.sitekey),"apihost"in o&&r(12,f=o.apihost),"hl"in o&&r(13,u=o.hl),"reCaptchaCompat"in o&&r(14,d=o.reCaptchaCompat),"theme"in o&&r(15,C=o.theme),"size"in o&&r(16,G=o.size)},e.$$.update=()=>{e.$$.dirty[0]&3252738&&E&&R&&(M=hcaptcha.render(`h-captcha-${O}`,{sitekey:g,hl:u,theme:C,callback:"onSuccess","error-callback":"onError","close-callback":"onClose","expired-callback":"onExpired",size:G}),r(21,y=window.document.getElementById("skeleton")),y&&y.remove())},[n,E,F,v,H,V,O,q,se,g,i,S,f,u,d,C,G,P,x,D,R,y,B,ae,$,I]}class vt extends Te{constructor(t){super(),ze(this,t,pt,ht,Ue,{domain:10,className:0,redirect:11,sitekey:9,apihost:12,hl:13,reCaptchaCompat:14,theme:15,size:16,reset:17,execute:18,toast:19},null,[-1,-1])}get reset(){return this.$$.ctx[17]}get execute(){return this.$$.ctx[18]}get toast(){return this.$$.ctx[19]}}export{vt as default};
